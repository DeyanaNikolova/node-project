<div class="card-group">
    <div class="card">
        <div class="card-body">
            <h5 class="card-title">Product</h5>
            <form method="POST" action="product">
                <div class="mb-3">
                    <label for="title" class="form-label">title</label>
                    <input type="text" class="form-control" id="title" name="title" id="title">
                </div>
                <div class="mb-3">
                    <label for="price" class="form-label">Price</label>
                    <input type="number" class="form-control" id="price" name="price" id="price">
                </div>
                <div class="mb-3">
                    <label for="amount" class="form-label">Amount</label>
                    <input type="number" class="form-control" id="amount" name="amount" id="amount">
                </div>
                <input name="postAction" type="text" value="create" id="postActionId" hidden/>
                <div class="mb-3" style="float: right">
                    <button type="submit" class="btn btn-success">Save</button>
                </div> 
            </form>
        </div>
    </div>
    <div class="card">
            <div class="card-body">
                <h5 class="card-title">Products List</h5>
                    <table class="table table-striped" id="productsTableId">
                        <thead>
                            <tr>
                                <th>Title</th> <th>Price</th> <th>Amount</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${products.map(product => `<tr><td>${product.title}</td> <td>${product.price}</td> <td>${product.amount}</td>
                            <td><button class="btn btn-danger btn-sm" onclick="remove('${product.title}')">Remove</button>
                            <button class="btn btn-info btn-sm" onclick="update('${product.title}')">Update</button>
                            </td></tr>`).reduce((e1, e2) => `${e1}${e2}`)}
                        </tbody>
                    </table>
            </div>
    </div>
    </div>
    </div>
    </div>
         <script>
            function logout(){
            window.location.href = '/connection';
            }

            let selectedTitle = null;

            function remove(title){
            selectedTitle = title;
            const http = new XMLHttpRequest();
            http.addEventListener("load", removeListener);
            http.open("DELETE", "/product?title=" + title);
            http.send();
            }

            function removeListener() {
           // console.log(this.responseText);

           let rows = document.getElementById('productsTableId').rows;
                for(let i = 0; i < rows.length; i++){
                    if(rows[i].childNodes[0].innerText === selectedTitle){
                         rows[i].remove();
                    }
                }
            }

            function update(title){
                let rows = document.getElementById('productsTableId').rows;
                for(let i = 0; i < rows.length; i++){
                    if(rows[i].childNodes[0].innerText === title){
                        document.getElementById('title').value=rows[i].childNodes[0].innerText;
                        document.getElementById('price').value=rows[i].childNodes[2].innerText;
                        document.getElementById('amount').value=rows[i].childNodes[4].innerText;
                    }
                }
            }

            let postAction = document.getElementById('postActionId');
            postAction.value = 'update';
        </script>
  